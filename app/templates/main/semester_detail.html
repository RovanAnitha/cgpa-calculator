{% extends "base.html" %}

{% block title %}{{ semester.name }} - CGPA Calculator{% endblock %}

{% block content %}
<div class="container">
    <h1>{{ semester.name }}</h1>
    <p class="subtitle">{{ semester.student.name }} ({{ semester.student.student_id }})</p>

    <div class="grading-scale">
        <h3>Grading Scale Reference</h3>
        <div class="scale-grid">
            <div class="scale-item"><strong>90-100:</strong> 10</div>
            <div class="scale-item"><strong>80-89:</strong> 9</div>
            <div class="scale-item"><strong>70-79:</strong> 8</div>
            <div class="scale-item"><strong>60-69:</strong> 7</div>
            <div class="scale-item"><strong>50-59:</strong> 6</div>
            <div class="scale-item"><strong>40-49:</strong> 5</div>
            <div class="scale-item"><strong>30-39:</strong> 4</div>
            <div class="scale-item"><strong>0-29:</strong> 0</div>
        </div>
    </div>

    <div class="results">
        <h2>Semester Results</h2>
        <div class="cgpa-display">GPA: {{ "%.2f"|format(semester.gpa) }}</div>

        <div class="stats">
            <div class="stat-box">
                <div class="stat-label">Total Credits</div>
                <div class="stat-value">{{ "%.1f"|format(semester.total_credits) }}</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">Courses</div>
                <div class="stat-value">{{ semester.courses.count() }}</div>
            </div>
        </div>
    </div>

    <div style="margin: 20px 0;">
        <a href="{{ url_for('main.create_course', semester_id=semester.id) }}" class="btn btn-success">+ Add Course</a>
        <a href="{{ url_for('main.edit_semester', id=semester.id) }}" class="btn btn-secondary">Edit Semester</a>
        <a href="{{ url_for('main.view_student', id=semester.student_id) }}" class="btn btn-secondary">Back to Student</a>
    </div>

    <h2>Courses</h2>

    {% if semester.courses.count() > 0 %}
        <table class="results-table">
            <thead>
                <tr>
                    <th>Course Name</th>
                    <th>Subject Area</th>
                    <th>Code</th>
                    <th>Credits</th>
                    <th>Marks</th>
                    <th>Grade Point</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for course in semester.courses.all() %}
                    <tr>
                        <td>{{ course.course_name }}</td>
                        <td>{{ course.subject_area or '-' }}</td>
                        <td>{{ course.course_code or '-' }}</td>
                        <td>{{ "%.1f"|format(course.credits) }}</td>
                        <td>{{ "%.1f"|format(course.marks) }}</td>
                        <td>{{ "%.1f"|format(course.grade_point) }}</td>
                        <td>
                            <a href="{{ url_for('main.edit_course', id=course.id) }}" class="btn btn-secondary" style="padding: 5px 10px; font-size: 0.85em;">Edit</a>
                            <form method="POST" action="{{ url_for('main.delete_course', id=course.id) }}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this course?');">
                                <button type="submit" class="btn btn-danger" style="padding: 5px 10px; font-size: 0.85em;">Delete</button>
                            </form>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <div style="text-align: center; padding: 40px; color: #666; background: #f8f9fa; border-radius: 10px;">
            <h3>No courses yet</h3>
            <p>Click "Add Course" to start tracking your grades!</p>
        </div>
    {% endif %}
</div>
{% endblock %}
